<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Painel de Atendimento - Klube Digital</title>
    <link rel="stylesheet" href="assents/css/admin-style.css">
</head>
<body>
    <!-- Overlay para a sidebar em mobile -->
    <div class="sidebar-overlay"></div>
    
    <!-- Header -->
    <header id="admin-header">
        <div class="container admin-header-container">
            <div class="mobile-menu-btn">
                <span></span>
                <span></span>
                <span></span>
            </div>
            <div class="logo">
                <img src="assents/img/klubedigitallogo.svg" alt="Klube Digital Logo" class="logo-img">
                <h1>Klube Digital</h1>
            </div>
            <div class="admin-user">
                <!-- O componente de notifica√ß√£o ser√° injetado aqui pelo JavaScript -->
                <span class="admin-name">Administrador</span>
                <a href="logout.php" class="admin-logout">Sair</a>
            </div>
        </div>
    </header>

    <!-- Sidebar -->
    <aside class="admin-sidebar">
        <nav class="sidebar-nav">
            <ul>
                <li class="active"><a href="#" data-section="dashboard"><span class="icon">üìä</span> Dashboard</a></li>
                <li><a href="#" data-section="contatos"><span class="icon">üë•</span> Contatos</a></li>
                <li><a href="#" data-section="atendimentos"><span class="icon">üí¨</span> Atendimentos</a></li>
                <li><a href="#" data-section="relatorios"><span class="icon">üìà</span> Relat√≥rios</a></li>
                <li><a href="#" data-section="configuracoes"><span class="icon">‚öôÔ∏è</span> Configura√ß√µes</a></li>
            </ul>
        </nav>
    </aside>

    <!-- Main Content -->
    <main class="admin-content">
        <!-- Dashboard Section -->
        <section id="dashboard" class="content-section active">
            <div class="section-header">
                <h2>Dashboard</h2>
                <p>Vis√£o geral dos atendimentos</p>
            </div>
            
            <div class="dashboard-cards">
                <div class="card card-pendentes">
                    <div class="card-content">
                        <h3>Pendentes</h3>
                        <p class="count" id="count-pendentes">0</p>
                    </div>
                    <div class="card-icon">üìù</div>
                </div>
                
                <div class="card card-em-atendimento">
                    <div class="card-content">
                        <h3>Em Atendimento</h3>
                        <p class="count" id="count-em-atendimento">0</p>
                    </div>
                    <div class="card-icon">üîÑ</div>
                </div>
                
                <div class="card card-concluidos">
                    <div class="card-content">
                        <h3>Conclu√≠dos</h3>
                        <p class="count" id="count-concluidos">0</p>
                    </div>
                    <div class="card-icon">‚úÖ</div>
                </div>
                
                <div class="card card-total">
                    <div class="card-content">
                        <h3>Total</h3>
                        <p class="count" id="count-total">0</p>
                    </div>
                    <div class="card-icon">üìä</div>
                </div>
            </div>
            
            <div class="section-header">
                <h3>Atendimentos Recentes</h3>
            </div>
            
            <div class="recent-contacts" id="recent-contacts">
                <div class="loading">Carregando...</div>
            </div>
        </section>

        <!-- Contatos Section -->
        <section id="contatos" class="content-section">
            <div class="section-header">
                <h2>Contatos</h2>
                <p>Gerencie todos os contatos recebidos</p>
            </div>
            
            <div class="filter-controls">
                <div class="search-box">
                    <input type="text" id="search-contatos" placeholder="Buscar por nome, cl√≠nica...">
                    <button id="btn-search"><span class="icon">üîç</span></button>
                </div>
                
                <div class="filter-status">
                    <label for="filter-status">Status:</label>
                    <select id="filter-status">
                        <option value="todos">Todos</option>
                        <option value="pendente">Pendentes</option>
                        <option value="em_atendimento">Em Atendimento</option>
                        <option value="concluido">Conclu√≠dos</option>
                        <option value="cancelado">Cancelados</option>
                    </select>
                </div>
                
                <button id="btn-refresh" class="btn-refresh">Atualizar</button>
            </div>
            
            <div class="contatos-table-container" id="contatos-table-container">
                <div class="loading">Carregando contatos...</div>
            </div>
        </section>

        <!-- Atendimentos Section -->
        <section id="atendimentos" class="content-section">
            <div class="section-header">
                <h2>Atendimentos</h2>
                <p>Gerencie os atendimentos em andamento</p>
            </div>
            
            <div class="filter-controls">
                <div class="filter-status">
                    <label for="filter-atendimentos-status">Status:</label>
                    <select id="filter-atendimentos-status">
                        <option value="em_atendimento">Em Atendimento</option>
                        <option value="todos">Todos</option>
                        <option value="pendente">Pendentes</option>
                        <option value="concluido">Conclu√≠dos</option>
                    </select>
                </div>
                
                <button id="btn-atendimentos-refresh" class="btn-refresh">Atualizar</button>
            </div>
            
            <div class="atendimentos-cards" id="atendimentos-cards">
                <div class="loading">Carregando atendimentos...</div>
            </div>
        </section>

        <!-- Relat√≥rios Section -->
        <section id="relatorios" class="content-section">
            <div class="section-header">
                <h2>Relat√≥rios</h2>
                <p>Estat√≠sticas e an√°lises de atendimentos</p>
            </div>
            
            <div class="filter-controls">
                <div class="date-range">
                    <label for="date-start">De:</label>
                    <input type="date" id="date-start">
                    
                    <label for="date-end">At√©:</label>
                    <input type="date" id="date-end">
                </div>
                
                <button id="btn-generate-report" class="btn-primary">Gerar Relat√≥rio</button>
            </div>
            
            <div class="report-charts">
                <div class="chart-container">
                    <h3>Atendimentos por Status</h3>
                    <canvas id="chart-status"></canvas>
                </div>
                
                <div class="chart-container">
                    <h3>Atendimentos por Dia</h3>
                    <canvas id="chart-timeline"></canvas>
                </div>
            </div>
            
            <div class="report-metrics">
                <div class="metric-card">
                    <h3>Tempo M√©dio de Resposta</h3>
                    <p class="metric" id="metric-tempo-resposta">--</p>
                </div>
                
                <div class="metric-card">
                    <h3>Taxa de Convers√£o</h3>
                    <p class="metric" id="metric-taxa-conversao">--</p>
                </div>
                
                <div class="metric-card">
                    <h3>Taxa de Conclus√£o</h3>
                    <p class="metric" id="metric-taxa-conclusao">--</p>
                </div>
            </div>
        </section>

        <!-- Configura√ß√µes Section -->
        <section id="configuracoes" class="content-section">
            <div class="section-header">
                <h2>Configura√ß√µes</h2>
                <p>Personalize suas configura√ß√µes de atendimento</p>
            </div>
            
            <div class="config-form-container">
                <form id="config-form">
                    <div class="form-group">
                        <h3>Configura√ß√µes Gerais</h3>
                        
                        <div class="input-group">
                            <label for="config-mensagem-padrao">Mensagem Padr√£o WhatsApp:</label>
                            <textarea id="config-mensagem-padrao" rows="3">Ol√° {nome}, referente ao seu atendimento {id} na Klube Digital. {mensagem_personalizada}</textarea>
                        </div>
                        
                        <div class="input-group">
                            <label for="config-tempo-resposta">Tempo M√°ximo de Resposta:</label>
                            <input type="text" id="config-tempo-resposta" value="24h">
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <h3>Notifica√ß√µes</h3>
                        
                        <div class="checkbox-group">
                            <input type="checkbox" id="config-notificacoes-email" checked>
                            <label for="config-notificacoes-email">Receber notifica√ß√µes por e-mail</label>
                        </div>
                        
                        <div class="checkbox-group">
                            <input type="checkbox" id="config-notificacoes-sistema" checked>
                            <label for="config-notificacoes-sistema">Receber notifica√ß√µes no sistema</label>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <h3>Usu√°rios</h3>
                        
                        <div class="users-list" id="users-list">
                            <div class="user-item">
                                <span class="user-name">Administrador</span>
                                <span class="user-email">admin@klubedigital.com.br</span>
                                <span class="user-role">Administrador</span>
                                <div class="user-actions">
                                    <button type="button" class="btn-edit-user">Editar</button>
                                </div>
                            </div>
                        </div>
                        
                        <button type="button" id="btn-add-user" class="btn-secondary">Adicionar Usu√°rio</button>
                    </div>
                    
                    <div class="form-actions">
                        <button type="submit" class="btn-primary">Salvar Configura√ß√µes</button>
                    </div>
                </form>
            </div>
        </section>
    </main>

    <!-- Modal de Contato -->
    <div id="modal-contato" class="modal">
        <div class="modal-content">
            <span class="close" id="modal-contato-close">&times;</span>
            <div id="modal-contato-content">
                <!-- Conte√∫do ser√° preenchido via JavaScript -->
            </div>
        </div>
    </div>

    <!-- Modal de Atualiza√ß√£o de Status -->
    <div id="modal-status" class="modal">
        <div class="modal-content">
            <span class="close" id="modal-status-close">&times;</span>
            <h2>Atualizar Status</h2>
            <form id="form-atualizar-status">
                <input type="hidden" id="status-contato-id">
                <div class="form-group">
                    <label for="status-select">Novo Status:</label>
                    <select id="status-select">
                        <option value="pendente">Pendente</option>
                        <option value="em_atendimento">Em Atendimento</option>
                        <option value="concluido">Conclu√≠do</option>
                        <option value="cancelado">Cancelado</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="status-observacao">Observa√ß√£o:</label>
                    <textarea id="status-observacao" rows="3" placeholder="Adicione uma observa√ß√£o (opcional)"></textarea>
                </div>
                <div class="form-actions">
                    <button type="submit" class="btn-primary">Atualizar</button>
                    <button type="button" id="btn-cancel-status" class="btn-secondary">Cancelar</button>
                </div>
            </form>
        </div>
    </div>

    <!-- JavaScript de inicializa√ß√£o r√°pida para garantir que a sidebar funcione -->
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Inicializa√ß√£o da sidebar para mobile
            const mobileMenuBtn = document.querySelector('.mobile-menu-btn');
            const sidebar = document.querySelector('.admin-sidebar');
            const overlay = document.querySelector('.sidebar-overlay');
            
            if (mobileMenuBtn && sidebar && overlay) {
                // Toggle sidebar ao clicar no bot√£o mobile
                mobileMenuBtn.addEventListener('click', function() {
                    this.classList.toggle('active');
                    sidebar.classList.toggle('active');
                    overlay.classList.toggle('active');
                    
                    // Impedir scroll no body quando sidebar estiver aberta
                    if (sidebar.classList.contains('active')) {
                        document.body.style.overflow = 'hidden';
                    } else {
                        document.body.style.overflow = '';
                    }
                });
                
                // Fechar sidebar ao clicar no overlay
                overlay.addEventListener('click', function() {
                    mobileMenuBtn.classList.remove('active');
                    sidebar.classList.remove('active');
                    this.classList.remove('active');
                    document.body.style.overflow = '';
                });
                
                // Fechar sidebar ao clicar em um link
                const sidebarLinks = sidebar.querySelectorAll('a');
                sidebarLinks.forEach(link => {
                    link.addEventListener('click', function(e) {
                        if (window.innerWidth <= 768) {
                            mobileMenuBtn.classList.remove('active');
                            sidebar.classList.remove('active');
                            overlay.classList.remove('active');
                            document.body.style.overflow = '';
                        }
                        
                        // Navega√ß√£o entre se√ß√µes
                        e.preventDefault(); // Impedir comportamento padr√£o do link
                        const targetSection = this.getAttribute('data-section');
                        if (targetSection) {
                            // Atualizar navega√ß√£o
                            document.querySelectorAll('.sidebar-nav li').forEach(item => {
                                item.classList.remove('active');
                            });
                            this.parentElement.classList.add('active');
                            
                            // Mostrar se√ß√£o correspondente
                            document.querySelectorAll('.content-section').forEach(section => {
                                section.classList.remove('active');
                            });
                            
                            const targetElement = document.getElementById(targetSection);
                            if (targetElement) {
                                targetElement.classList.add('active');
                            }
                        }
                    });
                });
            }
        });
    </script>

    <!-- JavaScript principal -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="assents/js/admin.js"></script>
</body>
</html>